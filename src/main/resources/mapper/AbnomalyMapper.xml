<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.roymark.queue.dao.AbnomalyMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.roymark.queue.entity.Abnomaly">
        <id column="abnomaly_hidden_id" property="abnomalyHiddenId" />
        <result column="abnomaly_id" property="abnomalyId" />
        <result column="abnomaly_event" property="abnomalyEvent" />
        <result column="abnomaly_start_date" property="abnomalyStartDate" />
        <result column="abnomaly_end_date" property="abnomalyEndDate" />
        <result column="abnomaly_confidence" property="abnomalyConfidence" />
        <result column="abnomaly_link" property="abnomalyLink" />
        <result column="window_hidden_id" property="windowHiddenId" />
        <result column="user_hidden_id" property="userHiddenId" />
        <result column="window_id" property="windowId" />
        <result column="window_name" property="windowName" />
        <result column="user_name" property="userName" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <select id="getAllAbnomaly" resultMap="BaseResultMap">
        SELECT br_abnomaly.*, br_user.user_id, br_user.user_name, br_window.window_id, br_window.window_name FROM (br_abnomaly INNER JOIN br_user ON br_abnomaly.user_hidden_id=br_user.user_hidden_id)
            INNER JOIN window ON abnomaly.window_hidden_id=window.window_hidden_id
    </select>

    <select id="getAbnomalyByHiddenId" parameterType="long" resultMap="BaseResultMap">
        SELECT br_abnomaly.*, br_user.user_id, br_user.user_name, br_window.window_id, br_window.window_name FROM (br_abnomaly INNER JOIN br_user ON br_abnomaly.user_hidden_id=br_user.user_hidden_id)
            INNER JOIN window ON abnomaly.window_hidden_id=window.window_hidden_id
        WHERE abnomaly.abnomaly_hidden_id=#{VALUE }
    </select>

    <select id="page" resultMap="BaseResultMap">
        SELECT br_abnomaly.*, br_user.user_id, br_user.user_name, br_window.window_id, br_window.window_name FROM (abnomaly INNER JOIN br_user ON br_abnomaly.user_hidden_id=br_user.user_hidden_id)
            INNER JOIN br_window ON br_abnomaly.window_hidden_id=br_window.window_hidden_id
        ${ew.customSqlSegment}
    </select>

</mapper>
